--- 
title: "Theory Construction and Statistical Modeling"
#subtitle: "A guide to structural equation modeling in R"
author: "Kyle M. Lang"
date: "Last updated: `r Sys.Date()`"
site: bookdown::bookdown_site
output: 
  bookdown::gitbook:
    config: 
      toc:
       collapse: section
#      search: yes
#      fontsettings:
#        size: 2
    split_by: section
    df_print: paged
documentclass: book
#bibliography: [../bibtex/book.bib, ../bibtex/packages.bib]
#biblio-style: apalike
#link-citations: yes
#description: "This is a guide for the elective course TCSM."
---

```{r global_options, include = FALSE}
library(knitr)
library(dplyr)

opts_chunk$set(warning = FALSE, message = FALSE)

dataDir  <- "../../data/"
```

# Course Information {-}

In order to test a theory, we must express the theory as a statistical model and 
then test this model on quantitative (numeric) data. This course uses existing 
tutorial datasets to practice the process of translating verbal theories into 
testable statistical models. If you are interested in the methods of acquiring 
high quality data to test your own theory, we recommend following the course 
*Conducting a Survey* which is taught from November to January.

In this course we will use datasets from different disciplines within the social 
sciences (educational sciences, psychology, and sociology) to explain and 
illustrate theories and practices that are used in all social science disciplines to statistically model social science theories.

Most information about the course is available in this GitBook. Course-related 
communication will be through <https://uu.blackboard.nl> (Log in with your 
student ID and password).

## Instructors

**Coordinator:**

[dr. Kyle M. Lang](https://www.kylemlang.com)

**Lectures**

[dr. Kyle M. Lang](https://www.kylemlang.com)

**Practicals**

[Rianne Kraakman](https://www.uu.nl/staff/amkraakman)

[Daniëlle Remmerswaal](https://www.uu.nl/staff/DMRemmerswaal)

## Course overview

This course comprises three parts:

1. *Factor analysis*: You will learn different ways of defining and estimating
unobserved constructs.
1. *Path analysis*: You will learn how to conduct regressions and ANOVAs as 
structural equation models with observed variables.
1. *Full structural equation modeling*: You will combine the first two topics by 
estimating path models using latent variables.

Each of these three themes will be evaluated with a separate assignment. Your 
course grade will be based on the weighted average of these three assignment 
grades.

### Schedule

```{r print_schedule, echo = FALSE}
schedule <- read.csv2("data/schedule.csv")
knitr::kable(schedule, 
             col.names = gsub("\\.", " ", colnames(schedule))
             )
```

## Learning goals

In this course you will learn how to translate a social scientific theory into a 
statistical model, how to analyze your data with these models, and how to 
interpret and report your results following APA standards.

After completing the course, you will be able to:

1. Translate a verbal theory into a conceptual model, and translate a conceptual 
model into a statistical model.
1. Independently analyze data using the free, open-source statistical software R.
1. Apply a *latent variable model* to a real-life problem wherein the observed 
variables are only indirect indicators of an unobserved construct.
1. Use a *path model* to represent the hypothesized causal relations among
several variables, including relationships such as mediation and moderation.
1. Explain to a fellow student how *structural equation modeling* combines 
latent variable models with path models and the benefits of doing so.
1. Reflect critically on the decisions involved in defining and estimating
structural equation models.

## Resources

### Literature

**You do not need a separate book for this course!** 

Most of the information is contained within this GitBook and the course readings 
(which you will be able to access via links in this GitBook). 

All literature is freely available online, as long as you are logging in from 
within the UU-domain (i.e., from the UU campus or through an appropriate VPN). 
All readings are linked in this GitBook via their DOIs. 

If you run into any trouble accessing a given article, searching for the title 
using [Google Scholar](www.scholar.google.com) or the 
[University Library](www.ubu.uu.nl) will probably due the trick.

### Software

You will do all of your statistical analyses with the statistical programming language/environment [R][r] and the add-on package [`lavaan`][lavaan].

- If you want to expand your learning, you can follow this excellent 
[`lavaan` tutorial](https://lavaan.ugent.be/tutorial/). Doing so is entirely 
optional, though.

## Reading questions

Along with every article, we will provide reading questions. You will not be 
graded on the reading questions, but it is important to prepare the reading 
questions before every lecture. The reading questions serve several important 
purposes:

-	Provide relevant background knowledge for the lecture
-	Help you recognize and understand the key terms and concepts
-	Make you aware of important publications that shaped the field
- Help you extract the relevant insights from the literature

## Weekly preparation

Before every class meeting (both lectures and practicals) you need to do the 
assigned homework (delineated in the GitBook chapter for that week). This course 
follows a *flipped classroom* procedure, so you must complete the weekly homework 
to meaningfully participate in, and benefit from, the class meetings.

### Background knowledge

We assume you have basic knowledge about multivariate statistics before entering 
this course. You do not need any prior experience working with R. If you wish to 
refresh your knowledge, we recommend the chapters on ANOVA, multiple regression,
and exploratory factor analysis from Field’s [*Discovering Statistics using R*][field]. 

If you cannot access the Field book, many other introductory statistics textbooks 
cover these topics equally well. So, use whatever you have lying around from 
past statistics courses. You could also try one of the following open-access options:

- [*Applied Statistics with R*][stats_with_r]
- [*Introduction to Modern Statistics*][modern_stats]
- [*Introduction to Statistical Learning*][isl]

## Grading

Your grade for the course is based on a “portfolio” composed of the three 
take-home assignments:

1. Latent variable modeling 

- Deadline: XXXX
- Group assignment
- Contributes 25% of your course grade

1. Path modeling 

- Deadline: XXXX
- Group assignment
- Contributes 25% of your course grade

1. Full Structural equation modeling 

- Deadline: XXXX
- Individual assignment
- Contributes 50% of your course grade

The specifics of the assignments are described in Chapter \@ref(assignments)

## Attendance

Attendance is not mandatory, but we strongly encourage you to attend all lectures 
and practicals. In our experience, students who actively participate tend to pass 
the course, whereas those who do not participate tend to drop out or fail. The 
lectures and practicals build on each other, so, in the unfortunate event that 
you have to miss a class meeting, please make sure you have caught up with the 
material before the next session.

[r]: https://www.r-project.org/
[lavaan]: https://www.lavaan.ugent.be/
[field]: https://www.discoveringstatistics.com/books/discovering-statistics-using-r/
[stats_with_r]: https://book.stat420.org/
[modern_stats]: https://openintro-ims.netlify.app/
[isl]: https://www.statlearning.com

<!--chapter:end:course_info.Rmd-->

```{r, include = FALSE}
library(dplyr)
library(foreign)
dataDir  <- "../../../data/"
imageDir <- "../images/"
partDir  <- "sections/"
```

<!--
\Sexpr{knit_child("w0_setup.Rmd", quiet = TRUE) %>% cat(sep = "\n")}
\Sepxr{knit_child("w0_basics.Rmd", quiet = TRUE) %>% cat(sep = "\n")}
\Sexpr{knit_child("w0_tutorial.Rmd", quiet = TRUE) %>% cat(sep = "\n")}
-->

```{r, echo = FALSE, message = FALSE, warning = FALSE, results = "asis"}
knitr::knit_child(paste0(partDir, "w0_setup.Rmd"), quiet = TRUE) %>% 
  cat(sep = "\n")
knitr::knit_child(paste0(partDir, "w0_basics.Rmd"), quiet = TRUE) %>% 
  cat(sep = "\n")
knitr::knit_child(paste0(partDir, "w0_tutorial.Rmd"), quiet = TRUE) %>% 
  cat(sep = "\n")
```

<!--chapter:end:week0.Rmd-->

# Introduction

```{r, include = FALSE}
library(dplyr)
dataDir  <- "../../../data/"
quizDir  <- "../assess/"
partDir  <- "sections/"
imageDir <- "../images/"
```

**Homework before lecture**

Work your way through the first two chapters of the GitBook online: https://cjvanlissa.github.io/TCSM/index.html. This will help you install the software required for the course, and get the data into R. You can skip the optional sections if you are already familiar with R.

Read the article by Smaldino (skip the red sections; the yellow section is optional). Answer the reading questions (on Blackboard). Plan a call with your learning team to discuss the second question. Reference:

Smaldino, P. E. (2017). Models are stupid, and we need more of 
them. Computational social psychology, 311-331.

**Lecture content**

We start with a brief introduction to the course, its goals and rules and the idea of statistical modelling. In this lecture we will introduce the type of models that will come across in this course. We will shortly discuss the concepts of model simplicity/complexity, model fit, the graphical display and the interpretation of different model parameters.  

**Homework before practical**

Perform the take-home exercise Regression (Chapter 3, Week 1 Home) before coming to the practical. 

**Practical content**

During the practical you will work on the class exercise about regression and SEM models.

```{r, echo = FALSE, message = FALSE, warning = FALSE, results = "asis"}
knitr::knit_child(paste0(partDir, "w1_lecture.Rmd"), quiet = TRUE) %>% 
  cat(sep = "\n")
knitr::knit_child(paste0(partDir, "w1_rq.Rmd"), quiet = TRUE) %>% 
  cat(sep = "\n")
knitr::knit_child(paste0(partDir, "w1_home.Rmd"), quiet = TRUE) %>% 
  cat(sep = "\n")
knitr::knit_child(paste0(partDir, "w1_class.Rmd"), quiet = TRUE) %>% 
  cat(sep = "\n")
knitr::knit_child(paste0(partDir, "w1_assess.Rmd"), quiet = TRUE) %>% 
  cat(sep = "\n")
```

<!--chapter:end:week1.Rmd-->

# EFA

```{r, include = FALSE}
library(dplyr)
dataDir <- "../../../data/"
quizDir <- "../assess/"
partDir <- "sections/"
```

**Homework before the lecture**

Read this week’s literature and finish the reading questions before coming to the lecture (see Blackboard for direct URLs)
Make sure to also answer the reading questions (on Blackboard).

- Preacher, Kristopher J. and MacCullum, Robert C. (2003) Repairing Tom Swift’s Electric Factor Analysis Machine, Understanding Statistics 2(1) 13-43.
- Kestilä, Elina (2006) Is There Demand for Radical Right Populism in the Finnish Electorate? Scandinavian Political Studies 29(3),169-191

**Lecture content**

This lecture forms an introduction to latent variables and scaling procedures. Different aspects of exploratory factor analysis will be discussed. Most notably we focus on the differences between Principal Component Analyses (PCA) and Factor Analysis, estimation and extraction methods, and factor axes rotations. The researcher has to take decisions on all these aspects when (s)he wants to analyse whether questions form a scale or not. Furthermore, reliability and factor scores are discussed as methods to construct and evaluate the properties of a scale.

**Homework before the practical**

Perform the take home exercise Exploratory Factor Analysis (EFA) before coming to the practical.

**Practical content**

During the practical, the take home exercise EFA is shortly discussed. After this, students can work on the class exercise EFA.

```{r, echo = FALSE, message = FALSE, warning = FALSE, results = "asis"}
knitr::knit_child(paste0(partDir, "w2_lecture.Rmd"), quiet = TRUE) %>% 
  cat(sep = "\n")
knitr::knit_child(paste0(partDir, "w2_rq.Rmd"), quiet = TRUE) %>% 
  cat(sep = "\n")
knitr::knit_child(paste0(partDir, "w2_home.Rmd"), quiet = TRUE) %>% 
  cat(sep = "\n")
knitr::knit_child(paste0(partDir, "w2_class.Rmd"), quiet = TRUE) %>% 
  cat(sep = "\n")
knitr::knit_child(paste0(partDir, "w2_assess.Rmd"), quiet = TRUE) %>% 
  cat(sep = "\n")
```

<!--chapter:end:week2.Rmd-->

